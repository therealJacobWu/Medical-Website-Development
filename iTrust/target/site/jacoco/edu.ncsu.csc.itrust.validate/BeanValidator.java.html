<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../.resources/report.css" type="text/css"/><link rel="shortcut icon" href="../.resources/report.gif" type="image/gif"/><title>BeanValidator.java</title><link rel="stylesheet" href="../.resources/prettify.css" type="text/css"/><script type="text/javascript" src="../.resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../.sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">iTrust</a> &gt; <a href="index.source.html" class="el_package">edu.ncsu.csc.itrust.validate</a> &gt; <span class="el_source">BeanValidator.java</span></div><h1>BeanValidator.java</h1><pre class="source lang-java linenums">package edu.ncsu.csc.itrust.validate;

import edu.ncsu.csc.itrust.enums.Gender;
import edu.ncsu.csc.itrust.exception.ErrorList;
import edu.ncsu.csc.itrust.exception.FormValidationException;


/**
 * Abstract class used by all validators that provides utility methods for checking formatting of a particular
 * field. Specify the Bean to be validated
 * 
 *  
 * 
 * @param &lt;T&gt;
 *            The bean type to be validated
 */
<span class="fc" id="L17">abstract public class BeanValidator&lt;T&gt; {</span>
	abstract public void validate(T bean) throws FormValidationException;
	
	/**
	 * Check the format against the given enum. isNullable will check if the string is empty or a Java null.
	 * Otherwise, an error message will be returned. Use this in conjunction with {@link ErrorList}.
	 * 
	 * @param name
	 * @param value
	 * @param format
	 * @param isNullable
	 * @return
	 */
	protected String checkFormat(String name, String value, ValidationFormat format, boolean isNullable) {
		 
<span class="fc" id="L32">		String errorMessage = name + &quot;: &quot; + format.getDescription();</span>
<span class="fc bfc" id="L33" title="All 4 branches covered.">		 if (value == null || &quot;&quot;.equals(value))</span>
<span class="fc bfc" id="L34" title="All 2 branches covered.">			return isNullable ? &quot;&quot; : errorMessage;</span>
<span class="fc bfc" id="L35" title="All 2 branches covered.">		else if (format.getRegex().matcher(value).matches())</span>
<span class="fc" id="L36">			return &quot;&quot;;</span>
		else
<span class="fc" id="L38">			return errorMessage;</span>
	}

	/**
	 * Check a long value against a particular format. isNullable will check if it is empty or a Java null.
	 * Otherwise, an error message will be returned. Use this in conjunction with {@link ErrorList}.
	 * 
	 * @param name
	 * @param longValue
	 * @param format
	 * @param isNullable
	 * @return
	 */
	protected String checkFormat(String name, Long longValue, ValidationFormat format, boolean isNullable) {
<span class="fc" id="L52">		String str = &quot;&quot;;</span>
<span class="pc bpc" id="L53" title="1 of 2 branches missed.">		if (longValue != null)</span>
<span class="fc" id="L54">			str = String.valueOf(longValue);</span>
<span class="fc" id="L55">		return checkFormat(name, str, format, isNullable);</span>
	}

	/**
	 * Check the format against the given enum. isNullable will check if it is a Java null. Otherwise, an
	 * error message will be returned. Use this in conjunction with {@link ErrorList}.
	 * 
	 * @param name
	 * @param doubleValue
	 * @param format
	 * @param isNullable
	 * @return
	 */
	protected String checkFormat(String name, Double doubleValue, ValidationFormat format, boolean isNullable) {
<span class="fc" id="L69">		String str = &quot;&quot;;</span>
<span class="pc bpc" id="L70" title="1 of 2 branches missed.">		if (doubleValue != null)</span>
<span class="fc" id="L71">			str = String.valueOf(doubleValue);</span>
<span class="fc" id="L72">		return checkFormat(name, str, format, isNullable);</span>
	}
	
	/**
	 * Check the format against the given enum. isNullable will check if it is a Java null. Otherwise, an
	 * error message will be returned. Use this in conjunction with {@link ErrorList}.
	 * 
	 * @param name
	 * @param doubleValue
	 * @param format
	 * @param isNullable
	 * @return
	 */
	protected String checkFormat(String name, Integer intValue, ValidationFormat format, boolean isNullable) {
<span class="fc" id="L86">		String str = &quot;&quot;;</span>
<span class="pc bpc" id="L87" title="1 of 2 branches missed.">		if (intValue != null)</span>
<span class="fc" id="L88">			str = String.valueOf(intValue);</span>
<span class="fc" id="L89">		return checkFormat(name, str, format, isNullable);</span>
	}

	/**
	 * Check against the proper gender
	 * 
	 * @param name
	 * @param gen
	 * @param format
	 * @param isNullable
	 * @return
	 */
	protected String checkGender(String name, Gender gen, ValidationFormat format, boolean isNullable) {
<span class="fc" id="L102">		String str = &quot;&quot;;</span>
<span class="fc bfc" id="L103" title="All 2 branches covered.">		if (gen != null)</span>
<span class="fc" id="L104">			str = gen.toString();</span>
<span class="fc" id="L105">		return checkFormat(name, str, format, isNullable);</span>
	}

	/**
	 * The that an integer is the proper format, and is in the correct range
	 * 
	 * @param name
	 * @param value
	 * @param lower
	 * @param upper
	 * @param isNullable
	 * @return
	 */
	protected String checkInt(String name, String value, int lower, int upper, boolean isNullable) {
<span class="pc bpc" id="L119" title="3 of 6 branches missed.">		if (isNullable &amp;&amp; (value == null || &quot;&quot;.equals(value)))</span>
<span class="fc" id="L120">			return &quot;&quot;;</span>
		try {
<span class="fc" id="L122">			int intValue = Integer.valueOf(value);</span>
<span class="pc bpc" id="L123" title="1 of 4 branches missed.">			if (lower &lt;= intValue &amp;&amp; intValue &lt;= upper)</span>
<span class="fc" id="L124">				return &quot;&quot;;</span>
<span class="fc" id="L125">		} catch (NumberFormatException e) {</span>
			// just fall through to returning the error message
<span class="fc" id="L127">		}</span>

<span class="fc" id="L129">		return name + &quot; must be an integer in [&quot; + lower + &quot;,&quot; + upper + &quot;]&quot;;</span>
	}

	/**
	 * Check that a double is in the proper format and is in the correct range
	 * 
	 * @param name
	 * @param value
	 * @param lower
	 * @param upper
	 * @return
	 */
	protected String checkDouble(String name, String value, double lower, double upper) {
		try {
<span class="fc" id="L143">			double doubleValue = Double.valueOf(value);</span>
<span class="pc bpc" id="L144" title="1 of 4 branches missed.">			if (lower &lt;= doubleValue &amp;&amp; doubleValue &lt; upper)</span>
<span class="fc" id="L145">				return &quot;&quot;;</span>
<span class="fc" id="L146">		} catch (NumberFormatException e) {</span>
			// just fall through to returning the error message
<span class="fc" id="L148">		}</span>
<span class="fc" id="L149">		return name + &quot; must be a decimal in [&quot; + lower + &quot;,&quot; + upper + &quot;)&quot;;</span>
	}

	/**
	 * Check that the value fits the &quot;true&quot; or &quot;false&quot;
	 * 
	 * @param name
	 * @param value
	 * @return
	 */
	protected String checkBoolean(String name, String value) {
<span class="pc bpc" id="L160" title="1 of 4 branches missed.">		if (&quot;true&quot;.equals(value) || &quot;false&quot;.equals(value))</span>
<span class="fc" id="L161">			return &quot;&quot;;</span>
		else
<span class="nc" id="L163">			return name + &quot; must be either 'true' or 'false'&quot;;</span>
	}
	
	protected String checkNotZero(String name, String value, ValidationFormat format, boolean isNullable) {
<span class="fc" id="L167">		String s = checkFormat(name, value, format, isNullable);</span>
<span class="fc bfc" id="L168" title="All 2 branches covered.">		if (s.equals(&quot;&quot;)) {</span>
<span class="fc bfc" id="L169" title="All 2 branches covered.">			if (Double.valueOf(value) &lt; 0.1) {</span>
<span class="fc" id="L170">				return name + &quot; must be greater than 0&quot;;</span>
			}
		}
<span class="fc" id="L173">		return s;</span>
	}
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.eclemma.org/jacoco">JaCoCo</a> 0.7.4.201502262128</span></div></body></html>